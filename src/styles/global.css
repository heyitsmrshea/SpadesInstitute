@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: light;
    /* Design tokens as CSS custom properties */
    --color-accent: #1e3a5f;
    --color-accent-hover: #0f2a4a;
    --color-focus: rgba(30, 58, 95, 0.4);
    --section-padding: 4rem;
    --section-padding-md: 5rem;

    /* Animation timing system */
    --duration-fast: 200ms;
    --duration-normal: 300ms;
    --duration-slow: 600ms;

    /* Easing functions */
    --ease-out: cubic-bezier(0.4, 0, 0.2, 1);
    --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);

    /* Elevation changes */
    --lift-small: -2px;
    --lift-medium: -4px;
    --lift-large: -8px;
  }

  html {
    scroll-behavior: smooth;
    font-size: 16px;
    /* Prevent horizontal scroll on mobile */
    overflow-x: hidden;
  }

  body {
    font-family: ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, Inter, sans-serif;
    background-color: #fbfbf7;
    color: #111827;
    margin: 0;
    font-size: 1rem;
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    /* Prevent horizontal scroll on mobile */
    overflow-x: hidden;
    /* Improve tap highlight on mobile */
    -webkit-tap-highlight-color: rgba(30, 58, 95, 0.1);
  }

  /* Headings - serif for H1/H2 only, sans for rest */
  h1,
  h2 {
    font-family: ui-serif, Georgia, Cambria, 'Times New Roman', Times, serif;
    font-style: italic;
    color: inherit;
    letter-spacing: -0.01em;
  }

  h3,
  h4,
  h5,
  h6 {
    font-family: ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, Inter, sans-serif;
    font-weight: 600;
    color: inherit;
  }

  /* Improved link accessibility */
  a {
    color: inherit;
    text-decoration-skip-ink: auto;
  }

  /* Underlines ONLY for inline body links (inside prose/paragraphs) */
  /* Exclude: buttons, nav, cards, articles, groups, and any link with explicit no-underline */
  .prose a:not(.btn):not(.nav-link),
  p a:not(.btn):not(.nav-link) {
    text-decoration: underline;
    text-decoration-color: rgba(30, 58, 95, 0.3);
    text-underline-offset: 2px;
    transition: text-decoration-color 0.2s ease;
  }

  .prose a:not(.btn):not(.nav-link):hover,
  p a:not(.btn):not(.nav-link):hover {
    text-decoration-color: var(--color-accent);
  }

  /* Selection highlight */
  ::selection {
    background: rgba(30, 58, 95, 0.15);
    color: inherit;
  }

  /* Focus visible for accessibility */
  :focus-visible {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
  }
}

@layer components {
  /* ============================================
     BUTTON SYSTEM
     Primary: Filled accent color (main action)
     Secondary: Outline accent color (alternative action)
     Tertiary: Text link style (minor action)
     ============================================ */

  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-lg px-5 py-3 text-sm font-semibold tracking-wide transition-all duration-200 ease-out focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
    text-transform: none;
    letter-spacing: 0.02em;
    /* Ensure minimum touch target size (44x44px) */
    min-height: 44px;
    /* Improve button text on mobile */
    @media (max-width: 640px) {
      padding-left: 1rem;
      padding-right: 1rem;
      font-size: 0.875rem;
    }
  }

  /* Primary - Main action, high emphasis */
  .btn-primary {
    @apply bg-spades-accent text-white shadow-card hover:bg-spades-accent-hover hover:shadow-lg hover:-translate-y-0.5 focus-visible:ring-spades-accent;
  }

  /* Secondary - Alternative action, medium emphasis */
  .btn-secondary {
    @apply border-2 border-spades-accent text-spades-accent bg-transparent hover:bg-spades-accent hover:text-white hover:-translate-y-0.5 focus-visible:ring-spades-accent;
  }

  /* Tertiary - Minor action, low emphasis */
  .btn-tertiary {
    @apply text-spades-accent underline underline-offset-4 decoration-spades-accent/30 hover:decoration-spades-accent px-0 py-0 focus-visible:ring-spades-accent;
  }

  /* Outline variant (alternative to secondary) */
  .btn-outline {
    @apply border border-spades-ink/20 text-spades-ink bg-transparent hover:border-spades-ink hover:bg-spades-ink/5 hover:-translate-y-0.5 focus-visible:ring-spades-ink;
  }

  /* Inverted for dark backgrounds */
  .btn-invert {
    @apply bg-white text-spades-ink shadow-card hover:bg-white/90 hover:shadow-card-hover hover:-translate-y-0.5 focus-visible:ring-white;
  }

  .btn-invert-outline {
    @apply border-2 border-white/60 text-white bg-transparent hover:border-white hover:bg-white/10 hover:-translate-y-0.5 focus-visible:ring-white;
  }

  /* Ghost button */
  .btn-ghost {
    @apply text-spades-muted hover:text-spades-ink px-3 py-2 focus-visible:ring-spades-ink;
  }

  /* ============================================
     CARD COMPONENTS
     ============================================ */

  .card {
    @apply bg-white border border-spades-border rounded-xl p-6 shadow-card transition-all duration-200;
  }

  .card-hover {
    @apply hover:shadow-card-hover hover:-translate-y-1;
  }

  .card-dark {
    @apply bg-white/5 border-white/10 text-white;
  }

  /* ============================================
     SECTION LAYOUT
     ============================================ */

  .section-padding {
    @apply py-12 md:py-16 lg:py-20;
  }

  .section-padding-sm {
    @apply py-8 md:py-12 lg:py-16;
  }

  .section-padding-lg {
    @apply py-16 md:py-20 lg:py-28;
  }

  /* Content width for optimal reading */
  .prose-width {
    @apply max-w-prose mx-auto;
  }

  /* ============================================
     TEXT UTILITIES
     ============================================ */

  .text-body {
    @apply text-base leading-relaxed text-spades-text-secondary;
  }

  .text-body-lg {
    @apply text-lg leading-relaxed text-spades-text-secondary;
  }

  /* Dark section text with better contrast */
  .text-dark-primary {
    @apply text-white;
  }

  .text-dark-secondary {
    @apply text-white/85;
  }

  .text-dark-muted {
    @apply text-white/70;
  }
}

@layer utilities {
  .flag-real {
    filter: saturate(1.05) contrast(1.05);
    box-shadow: 0 12px 26px rgba(15, 23, 42, 0.2);
    transform: perspective(800px) rotateX(4deg);
  }

  .clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .hover-lift {
    @apply transition-all duration-200 hover:-translate-y-1 hover:shadow-card-hover;
  }

  .hover-glow {
    @apply transition-shadow duration-200 hover:shadow-lg;
  }

  /* Focus utilities */
  .focus-accent {
    @apply focus-visible:ring-2 focus-visible:ring-spades-accent focus-visible:ring-offset-2;
  }

  .focus-white {
    @apply focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-offset-2 focus-visible:ring-offset-spades-ink;
  }

  /* Mobile-specific utilities */
  .mobile-container {
    @apply px-4 sm:px-6;
  }

  .mobile-text-sm {
    @apply text-sm sm:text-base;
  }

  .mobile-text-base {
    @apply text-base sm:text-lg;
  }

  /* Ensure links and buttons have proper touch targets on mobile */
  a, button, summary {
    min-height: 44px;
    min-width: 44px;
    display: inline-flex;
    align-items: center;
  }

  /* Override for inline text links */
  p a, .prose a {
    min-height: auto;
    min-width: auto;
    display: inline;
  }
}

/* Smooth transitions for all interactive elements */
article,
a,
button {
  transition-property: transform, box-shadow, opacity, background-color, border-color, color;
  transition-duration: 200ms;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

/* Intersection Observer Animations */
.fade-in-on-scroll {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.fade-in-on-scroll.visible {
  opacity: 1;
  transform: translateY(0);
}

.slide-in-left {
  opacity: 0;
  transform: translateX(-30px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.slide-in-left.visible {
  opacity: 1;
  transform: translateX(0);
}

.slide-in-right {
  opacity: 0;
  transform: translateX(30px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.slide-in-right.visible {
  opacity: 1;
  transform: translateX(0);
}

.scale-in {
  opacity: 0;
  transform: scale(0.95);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.scale-in.visible {
  opacity: 1;
  transform: scale(1);
}

/* Loading Skeletons */
.skeleton {
  background: linear-gradient(90deg,
      #f3f4f6 0%,
      #e5e7eb 50%,
      #f3f4f6 100%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s ease-in-out infinite;
}

@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }

  100% {
    background-position: -200% 0;
  }
}

.skeleton-text {
  @apply skeleton rounded h-4 mb-2;
}

.skeleton-title {
  @apply skeleton rounded h-8 mb-4;
}

.skeleton-image {
  @apply skeleton rounded aspect-video w-full;
}

/* Tooltip */
.tooltip {
  position: relative;
}

.tooltip::before,
.tooltip::after {
  position: absolute;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease, transform 0.2s ease;
  z-index: 1000;
}

.tooltip::before {
  content: attr(data-tooltip);
  background: #1e3a5f;
  color: white;
  padding: 0.5rem 0.75rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  white-space: nowrap;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(-4px);
  margin-bottom: 0.5rem;
}

.tooltip::after {
  content: '';
  border: 6px solid transparent;
  border-top-color: #1e3a5f;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(2px);
}

.tooltip:hover::before,
.tooltip:hover::after {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {

  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  .fade-in-on-scroll,
  .slide-in-left,
  .slide-in-right,
  .scale-in,
  .reveal-up,
  .reveal-left,
  .reveal-right,
  .reveal-scale,
  .blur-reveal {
    opacity: 1;
    transform: none;
    filter: none;
  }
}

/* ============================================
   SCROLL-TRIGGERED REVEAL ANIMATIONS
   Modern, diverse animations triggered by scroll
   ============================================ */

.reveal-up,
.reveal-left,
.reveal-right,
.reveal-scale,
.blur-reveal {
  opacity: 0;
  transition: opacity 0.7s ease-out, transform 0.7s ease-out, filter 0.7s ease-out;
  will-change: opacity, transform;
}

/* Fallback: if JavaScript doesn't run, show content after a delay */
/* This ensures content is visible even if JS fails */
.reveal-up:not(.revealed),
.reveal-left:not(.revealed),
.reveal-right:not(.revealed),
.reveal-scale:not(.revealed),
.blur-reveal:not(.revealed) {
  animation: fade-in-fallback 0.1s ease-out 0.3s forwards;
}

@keyframes fade-in-fallback {
  to {
    opacity: 1;
    transform: translateY(0) translateX(0) scale(1);
    filter: blur(0);
  }
}

.reveal-up {
  transform: translateY(40px);
}

.reveal-left {
  transform: translateX(-40px);
}

.reveal-right {
  transform: translateX(40px);
}

.reveal-scale {
  transform: scale(0.92);
}

.blur-reveal {
  transform: translateY(20px);
  filter: blur(8px);
}

/* Revealed state */
.reveal-up.revealed,
.reveal-left.revealed,
.reveal-right.revealed,
.reveal-scale.revealed,
.blur-reveal.revealed {
  opacity: 1;
  transform: translateY(0) translateX(0) scale(1);
  filter: blur(0);
}

/* Stagger delays for children */
.stagger-children>*:nth-child(1) {
  transition-delay: 0ms;
}

.stagger-children>*:nth-child(2) {
  transition-delay: 100ms;
}

.stagger-children>*:nth-child(3) {
  transition-delay: 200ms;
}

.stagger-children>*:nth-child(4) {
  transition-delay: 300ms;
}

.stagger-children>*:nth-child(5) {
  transition-delay: 400ms;
}

.stagger-children>*:nth-child(6) {
  transition-delay: 500ms;
}

/* ============================================
   ENHANCED DEPTH CARDS
   Government-grade professionalism with subtle depth
   ============================================ */

.depth-card {
  @apply bg-white border border-spades-border rounded-xl transition-all duration-300;
  box-shadow:
    0 4px 6px -1px rgba(15, 23, 42, 0.05),
    0 2px 4px -2px rgba(15, 23, 42, 0.05);
}

.depth-card:hover {
  transform: translateY(-6px);
  box-shadow:
    0 20px 40px -10px rgba(15, 23, 42, 0.12),
    0 8px 16px -8px rgba(15, 23, 42, 0.08),
    0 0 0 1px rgba(30, 58, 95, 0.05);
}

.depth-card-dark {
  @apply bg-white/5 border-white/10;
}

.depth-card-dark:hover {
  @apply bg-white/10 border-white/20;
  box-shadow:
    0 20px 40px -10px rgba(0, 0, 0, 0.3),
    0 0 40px rgba(255, 255, 255, 0.05);
}

/* ============================================
   ENHANCED BUTTONS WITH SHIMMER
   Professional micro-interactions
   ============================================ */

.btn-shimmer {
  position: relative;
  overflow: hidden;
}

.btn-shimmer::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(105deg,
      transparent 40%,
      rgba(255, 255, 255, 0.3) 50%,
      transparent 60%);
  transform: translateX(-100%);
  transition: transform 0.6s ease;
}

.btn-shimmer:hover::after {
  transform: translateX(100%);
}

.btn-glow {
  transition: box-shadow 0.3s ease;
}

.btn-glow:hover {
  box-shadow:
    0 0 20px rgba(30, 58, 95, 0.3),
    0 4px 12px rgba(30, 58, 95, 0.15);
}

/* ============================================
   ANIMATED BACKGROUND PATTERNS
   Subtle tech-inspired backgrounds
   ============================================ */

.bg-grid-subtle {
  background-image:
    linear-gradient(rgba(30, 58, 95, 0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(30, 58, 95, 0.03) 1px, transparent 1px);
  background-size: 40px 40px;
}

.bg-grid-animated {
  background-image:
    linear-gradient(rgba(30, 58, 95, 0.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(30, 58, 95, 0.04) 1px, transparent 1px);
  background-size: 40px 40px;
  animation: gridPulse 4s ease-in-out infinite;
}

@keyframes gridPulse {

  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.6;
  }
}

.bg-hex-pattern {
  background-color: transparent;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%231e3a5f' fill-opacity='0.03'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}

.bg-dots-pattern {
  background-image: radial-gradient(circle at 1px 1px, rgba(30, 58, 95, 0.08) 1px, transparent 0);
  background-size: 24px 24px;
}

/* ============================================
   HEADER SCROLL EFFECTS
   Professional scroll-based enhancements
   ============================================ */

.nav-scrolled {
  background-color: rgba(10, 15, 28, 0.98) !important;
  backdrop-filter: blur(12px);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  border-color: transparent !important;
}

/* ============================================
   SECTION DIVIDERS
   Visual breaks between content areas
   ============================================ */

.section-divider {
  @apply relative h-px bg-spades-border my-12;
}

.section-divider::before {
  content: '';
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%) scaleX(0);
  width: 60px;
  height: 3px;
  background: linear-gradient(90deg, transparent, var(--color-accent), transparent);
  border-radius: 2px;
  transition: transform 0.8s ease-out;
}

.section-divider.revealed::before {
  transform: translate(-50%, -50%) scaleX(1);
}

/* ============================================
   ENHANCED ACCORDIONS
   Smooth open/close animations
   ============================================ */

details summary {
  transition: background-color 0.2s ease;
}

details[open] summary {
  @apply bg-spades-paper/50;
}

details>div {
  animation: accordionOpen 0.3s ease-out;
}

@keyframes accordionOpen {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ============================================
   FORM FOCUS ANIMATIONS
   Professional input interactions
   ============================================ */

.input-focus-glow {
  transition: box-shadow 0.2s ease, border-color 0.2s ease;
}

.input-focus-glow:focus {
  box-shadow:
    0 0 0 3px rgba(30, 58, 95, 0.1),
    0 0 20px rgba(30, 58, 95, 0.05);
}

/* ============================================
   PEOPLE/TEAM CARD EFFECTS
   Professional photo interactions
   ============================================ */

.team-card {
  @apply transition-all duration-300;
}

.team-card:hover {
  @apply -translate-y-1;
}

.team-card:hover .team-photo {
  @apply scale-105;
  box-shadow: 0 8px 24px rgba(15, 23, 42, 0.15);
}

.team-photo {
  @apply transition-all duration-300;
}

/* ============================================
   ANIMATED LINE CONNECTORS
   For step flows and timelines
   ============================================ */

.line-connector {
  @apply relative;
}

.line-connector::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 100%;
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, var(--color-accent), transparent);
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.6s ease-out;
}

.line-connector.revealed::after {
  transform: scaleX(1);
}

/* ============================================
   GLOW EFFECTS
   Subtle ambient lighting
   ============================================ */

.glow-accent {
  box-shadow: 0 0 40px rgba(30, 58, 95, 0.15);
}

.glow-white {
  box-shadow: 0 0 60px rgba(255, 255, 255, 0.1);
}

/* ============================================
   COUNTER ANIMATION SUPPORT
   For animated statistics
   ============================================ */

.counter-value {
  font-variant-numeric: tabular-nums;
  font-feature-settings: 'tnum';
}